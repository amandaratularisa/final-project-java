package com.game.mario;

import javafx.scene.canvas.GraphicsContext;
import javafx.scene.paint.Color;

public class Player {
    private double x, y;
    private double velocityX, velocityY;
    private double width = 40;
    private double height = 50;
    private boolean isJumping = false;
    private boolean onGround = false;
    private boolean facingRight = true;
    private int health = 100;
    private int coins = 0;
    
    private static final double GRAVITY = 0.8;
    private static final double JUMP_STRENGTH = -15;
    private static final double MOVE_SPEED = 3.2;
    private static final double MAX_FALL_SPEED = 15;
    
    public Player(double startX, double startY) {
        this.x = startX;
        this.y = startY;
    }
    
    public void update() {
        velocityY += GRAVITY;
        
        if (velocityY > MAX_FALL_SPEED) {
            velocityY = MAX_FALL_SPEED;
        }
        
        y += velocityY;
        x += velocityX;
        
        velocityX *= 0.7;
    }
    
    public void jump() {
        if (onGround) {
            velocityY = JUMP_STRENGTH;
            isJumping = true;
            onGround = false;
        }
    }
    
    public void moveLeft() {
        velocityX = -MOVE_SPEED;
        facingRight = false;
    }
    
    public void moveRight() {
        velocityX = MOVE_SPEED;
        facingRight = true;
    }
    
    public void draw(GraphicsContext gc) {
        gc.setFill(Color.RED);
        gc.fillRect(x, y, width, height);
        
        gc.setFill(Color.WHITE);
        gc.fillRect(x + 10, y + 10, 8, 8);
        gc.fillRect(x + 22, y + 10, 8, 8);
        
        gc.setFill(Color.BLACK);
        if (facingRight) {
            gc.fillRect(x + 25, y + 30, 10, 5);
        } else {
            gc.fillRect(x + 5, y + 30, 10, 5);
        }
    }
    
    public void takeDamage(int damage) {
        health -= damage;
        if (health < 0) health = 0;
    }
    
    public void collectCoin() {
        coins++;
    }
    
    public boolean isAlive() {
        return health > 0;
    }
    
    public double getX() { return x; }
    public double getY() { return y; }
    public double getWidth() { return width; }
    public double getHeight() { return height; }
    public double getVelocityY() { return velocityY; }
    public int getHealth() { return health; }
    public int getCoins() { return coins; }
    
    public void setX(double x) { this.x = x; }
    public void setY(double y) { this.y = y; }
    public void setVelocityY(double vy) { this.velocityY = vy; }
    public void setOnGround(boolean onGround) { 
        this.onGround = onGround;
        if (onGround) isJumping = false;
    }
}
